<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>个人信息</title>
  <meta name="referrer" content="never">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/user.css">
  <link rel="stylesheet" href="../css/join-step.css">
</head>
<body>

<header class="tx-header">
  <div class="header-box tx-box">
    <div class="logo">
      <i></i>
      <img src="../img/index-tailorx.png">
    </div>

    <ul class="menu">
      <li>
        <div class="title" onclick="window.location.href = '/index.html'">首页</div>
      </li>
      <li class="has-menu store">
        <div class="title" onclick="window.location.href = '/view/store-list.html'">门店介绍</div>
        <div class="child-menu">
          <ul>
            <li onclick="window.location.href = '/view/store-list.html'">全部</li>
          </ul>
        </div>
      </li>
      <li>
        <div class="title" onclick="window.location.href = '/view/main-depot.html'">时尚资讯</div>
      </li>
      <li>
        <div class="title" onclick="window.location.href = '/view/join.html'">招商加盟</div>
      </li>
      <li>
        <div class="title" onclick="window.location.href = '/view/recruit.html'">诚聘英才</div>
      </li>
    </ul>

    <div class="login tx-hide">
      <div class="no-user">
        <h4>登录</h4>
        <h3>注册</h3>
      </div>
      <div class="user">
        <div class="user-img" onclick="window.location.href = '/view/user-info.html'"></div>
        <h5 onclick="window.location.href = '/view/user-info.html'" class="user-name"></h5>
        <h4 onclick="TxMain.event.logout()">退出</h4>
        <!--<ul class="user-nav">
          <li onclick="window.location.href = '/view/user-info.html'">个人信息</li>
          <li onclick="TxMain.event.logout()">退出登录</li>
        </ul>-->
      </div>
    </div>
  </div>
</header>


<!--<div class="tx-box">
  <ul class="tx-nvaBar">
    <li>您现在的位置：</li>
    <li onclick="window.history.go(-1)">招商加盟&nbsp;&nbsp;&gt;&nbsp;&nbsp;</li>
    <li>个人信息</li>
  </ul>
</div>-->

<div class="tx-box" id="join-step-app" style="position: relative;margin-top: 110px;">
  <ul class="user-menu">
    <li onclick="window.location.href = 'user-info.html'">个人信息</li>
    <li class="active" id="go-joinStep">加盟流程</li>
  </ul>

  <div class="user-box">
    <ul class="step-box">
      <li class="active">
        <i class="icon"></i>
        <div class="text">
          <h6>第一步</h6>
          <h5>提交申请</h5>
        </div>
      </li>
      <li>
        <i class="icon"></i>
        <div class="text">
          <h6>第二步</h6>
          <h5>支付费用</h5>
        </div>
      </li>
      <li>
        <i class="icon"></i>
        <div class="text">
          <h6>第三步</h6>
          <h5>资料审核</h5>
        </div>
      </li>
      <li>
        <i class="icon"></i>
        <div class="text">
          <h6>第四步</h6>
          <h5>达成合作</h5>
        </div>
      </li>
    </ul>

    <div class="content">
      <div class="user-form-item" :class="{'input-focus':stepData.realName}">
        <label class="title">授权人真实姓名</label>
        <input type="text" class="user-input" v-model="stepData.realName"/>
      </div>

      <div class="user-form-item" :class="{'input-focus':stepData.icard}">
        <label class="title">授权人身份证号</label>
        <input type="text" class="user-input" v-model="stepData.icard"/>
      </div>

      <div class="user-form-item" :class="{'input-focus':stepData.phone}">
        <label class="title">授权人联系电话</label>
        <input type="text" class="user-input" v-model="stepData.phone"/>
      </div>

      <div>
        <i class="tx-checkbox" :class="{'active':isAgree}" @click="isAgree = !isAgree"></i>阅读并同意
        <span style="color: #1E90FF;cursor: pointer" @click="showText = true">《TAILORX网店加盟协议》</span>
      </div>

      <div style="margin-top: 50px" class="user-btn" id="submit-step" @click="submit">下一步</div>
    </div>
  </div>

  <div class="join-shade-text" :class="{show:showText}" @click="showText = false">
    <iframe class="box" src="join-agreement.html"></iframe>
  </div>

</div>

<div style="height: 320px;position: relative">
  <footer class="tx-footer">
    <div class="bottom">
      <div class="tx-box">
        <h6>Copyright © 2015-2017 ICP备16040571号-1&nbsp;&nbsp;&nbsp;&nbsp;上海顶顺线艺电子商务有限公司 版权所有<br>
          赤乌软件(C5NET.CN)提供技术支持</h6>

        <div class="qrcode">
          <img src="../img/qr_code.png">
          <h4>TailorX手机客户端</h4>
        </div>
      </div>
    </div>
  </footer>
</div>



<script type="text/javascript" src="../js/main.js"></script>
<script type="text/javascript">
  var _hmt = _hmt || [];
  (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?5a9341a0f2cc7b49dff1b89a8c8e54c3";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();

</script>
<script src='//kefu.easemob.com/webim/easemob.js'></script>
<script type="text/javascript">
  (function () {
    var html = $('<div class="tx-fixed-nav customer-service" id="tx-customer-service"><ul><li>联系客服<i style=" background-image: url(../img/ic_nav_customer_service.png)"></i></li></ul></div>');

    var user = store.get('tx-user') || {};
    window.easemobim = window.easemobim || {};
    easemobim.config = {
      hide: true, // 隐藏自带按钮
      autoConnect: true,
      visitor: {                   //为必须设置。名字和联系方式               昵称-手机号-user_id        （user_id 写在 description里面）
        trueName: '',
        qq: '',
        phone: '',
        companyName: '',
        userNickname: '',
        description: '',
        email: ''
      }
    };

    html.on('click', function () {
      easemobim.bind({configId: 'cbe22b74-e46c-4348-9ac8-12c605fa0366'});
    });
    $('body').append(html);
  })();
</script>

<script type="text/javascript" src="../lib/js/vue.min.js"></script>
<script type="text/javascript" src="../lib/layer/layer.js"></script>
<script type="text/javascript">

  TxMain.init.joinStep()
    .then(function () {
      new Vue({
        el: '#join-step-app',
        data: {
          stepData: {},
          isAgree: false,
          showText: false
        },
        created: function () {
          var step = store.get('tx-join-step');

          TxMain.event.checkJoinStep();

          setTimeout(function () {
            $('.user-form-item .user-input').on('focus', function () {
              $(this).parents('.user-form-item').addClass('input-focus');
            }).on('focusout', function () {
              if (!$(this).val()) {
                $(this).parents('.user-form-item').removeClass('input-focus');
              }
            });
          }, 0);

          if (_.isEmpty(step)) {
            return false;
          }


          this.stepData.realName = step.realName;
          this.stepData.icard = step.icard;
          this.stepData.phone = step.phone;
          this.stepData.id = step.id;

        },
        methods: {
          submit: function () {
            var _this = this;

            if (!this.stepData.realName || !this.stepData.icard || !this.stepData.phone) {
              return layer.tips('请填写完整信息', '#submit-step', {tips: 1});
            }

            if (this.stepData.realName.length > 10) {
              return layer.tips('名字只能输入10个字以内', '#submit-step', {tips: 1});
            }
            if (!this.isAgree) {
              return layer.tips('请阅读TAILORX网店加盟协议', '#submit-step', {tips: 1});
            }

            $.http.post({
              url: '/v3/web/certigier',
              data: _this.stepData
            }).then(function () {
              store.remove('tx-join-step');
              TxMain.init.joinStep().then(function () {
                window.location.href = 'join-stop-2.html';
              });
            });
          }
        }
      });
    });


</script>
</body>
</html>